<?xml version="1.0" encoding="UTF-8"?>
<!-- ===================================================================== -->
<!--                                                                       -->
<!--  This service will deploy the barrier object "BarrierObjectName"      -->
<!--  when the server is started.                                           -->
<!-- ===================================================================== -->

<server>
   <mbean code="org.jboss.system.BarrierController"
          name="jboss.ha:service=ServerStartedBarrierController,type=BarrierController">
    
      <!-- Dependent services will depend on this mbean -->
      <attribute name="BarrierObjectName">jboss.system:service=ServerStarted,type=Barrier</attribute>
    
      <!-- Whether to subscribe for notifications after startup -->
      <attribute name="DynamicSubscriptions">true</attribute>    
      <!-- The notification subscription handback that starts the barrier -->
      <attribute name="StartBarrierHandback">start</attribute>
      <!-- The notification subscription handback that stops the barrier -->
      <attribute name="StopBarrierHandback">stop</attribute>
    
      <!-- The notifications to subscribe for, along with their handbacks -->
      <attribute name="SubscriptionList">
         <subscription-list>
            <mbean name="jboss.system:type=Server" handback="start">
               <filter factory="NotificationFilterSupportFactory">
                  <enable type="org.jboss.system.server.started"/>
               </filter>
            </mbean>
            <mbean name="jboss.system:type=Server" handback="stop">
               <filter factory="NotificationFilterSupportFactory">
                  <enable type="org.jboss.system.server.stopped"/>
               </filter>
            </mbean>        
         </subscription-list>
      </attribute>
   </mbean>
   
</server>
